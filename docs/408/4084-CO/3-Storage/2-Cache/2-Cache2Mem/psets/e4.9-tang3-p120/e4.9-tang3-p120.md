
# e4.9-tang3-p120

![](assets/e4.9-tang3-p120.png)

## key

![](assets/e4.9-tang3-p120-key1.png)
![](assets/e4.9-tang3-p120-key2.png)
![](assets/e4.9-tang3-p120-key3.png)
![](assets/e4.9-tang3-p120-key4.png)

## sol

w: 访存地址为字地址

mem = 512k * 16b = 512kw = $2^{19}$w

cache = 4096 * 16b = 4096w = $2^{12}$w

block = 4w = $2^2$w

1w = 16b

### 1. direct

cache blocks = cache size / block size = $\frac{2^{12}}{2^2}=2^{10}$

| tag                 | index                   | offset         |
| ------------------- | ----------------------- | -------------- |
| mem = $2^{19}$w     | cache blocks = $2^{10}$ | block = $2^2$w |
| 主存字块标记              | Cache字块地址               | 字块内地址          |
| **7 = 19 - 10 - 2** | **10**                  | **2**          |

### 2. fully associative

| tag             | offset         |
| --------------- | -------------- |
| 主存字块标记          | 字块内地址          |
| mem = $2^{19}$w | block = $2^2$w |
| 17 = 19 - 2     | 2              |

### 3. 2 set associative

$$
\text{cache sets} = \frac{\text{cache blocks}}{2}\text{(二路组相联)}= 2^{9}\text{sets}
$$


| tag                | set index          | offset         |
| ------------------ | ------------------ | -------------- |
| 主存字块标记             | 组地址                | 字块内地址          |
| mem = $2^{19}$w    | cache sets = $2^9$ | block = $2^2$w |
| **8 = 19 - 9 - 2** | **9**              | **2**          |

### 4. 4 set associative

mem = 512k * 32 = 512k * 2w = $2^{20}$ w

$$
\text{cache sets} 
= \frac{\text{cache blocks}}{4}\text{(二路组相联)}
= \frac{2^{10}}{2^2}
= 2^{8}\text{sets}
$$

| tag                 | set index          | offset         |
| ------------------- | ------------------ | -------------- |
| 主存字块标记              | 组地址                | 字块内地址          |
| mem = $2^{20}$w     | cache sets = $2^8$ | block = $2^2$w |
| **10 = 20 - 8 - 2** | **8**              | **2**          |
