
# 中断处理中的优先级与屏蔽机制

---

## 一、基本概念

### 1. 中断源（Interrupt Source）

引发**中断事件**的硬件或软件单元，常见如：

- 外设（如键盘、定时器、I/O控制器）
    
- 软件指令（如软中断）
    
- CPU 检测异常（如除零错）
    

每个中断源通常有**唯一编号**，配有独立的**中断请求线（IRQ）**，向 CPU 发出中断请求。

---

### 2. 中断服务程序（Interrupt Service Routine，ISR）

当某中断源被响应时，CPU 转入执行的**专用程序段**，用于处理该中断事件。

基本流程：

- 保存现场
    
- 处理中断
    
- 恢复现场
    
- 中断返回（`IRET`）
    

---

### 3. 屏蔽字（Mask Word）

用于**屏蔽/允许中断源**发出的请求，常存放于**中断控制器或状态寄存器**中。

- 每个中断源对应一位：
    
    - `0`：允许中断
        
    - `1`：屏蔽（即使发生也不响应）
        

常用于软件动态控制中断开关、优先级调度。

---

## 二、中断优先级控制机制

### 1. **硬件排队优先次序（Hardware Priority Queuing）**

硬件层面对多个中断请求的响应顺序进行排队处理。

常见方式：

- **固定优先级**：如 IRQ0 > IRQ1 > IRQ2…
    
- **可编程优先级**：通过可编程中断控制器（如 8259A）设置
    
- **链式查询（Daisy Chain）**：设备通过串联排队，越靠前优先级越高
    

---

### 2. 中断源的中断处理次序（Interrupt Handling Order）

多个中断源同时请求时，实际响应哪一个，由系统优先级机制决定。

举例（经典优先级）：

```
硬盘控制器 > 定时器 > 串口 > 键盘
```

处理过程：

- 高优先级中断可打断低优先级中断服务程序
    
- 若 CPU 处于中断禁止状态或该中断源被屏蔽，则不会响应
    

---

## 三、联系与实例分析

### 示例题：

> 某系统有 4 个中断源，优先级从高到低为 A > B > C > D，且均可屏蔽。若当前处理中断 B，此时中断 A 到来，系统会如何响应？

**答：**  
若中断允许嵌套，且 A 未被屏蔽 → 中断 B 会被打断 → CPU 转而处理 A → 再返回继续 B。

---

## 四、相关领域联系

- 操作系统中的中断向量表（Interrupt Vector Table）管理各 ISR 的入口地址
    
- 嵌入式系统/单片机中对中断优先级有极高要求，如 STM32/NVIC 模块
    

---

## ✅ 推荐关键词

- Interrupt Source
    
- ISR（Interrupt Service Routine）
    
- Mask Bit / Mask Word
    
- Interrupt Priority
    
- Daisy Chain
    