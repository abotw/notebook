# DMA周期窃取（Cycle Stealing）

## 一、什么是 DMA 周期窃取？

**DMA 周期窃取**（**Cycle Stealing**）是指**DMA 控制器在数据传输时暂时占用 CPU 的总线周期**，每次传送一个数据单位后再将控制权交还给 CPU 的一种 **总线访问方式**。

---

## 二、提出周期窃取的背景

### 问题来源：

- 在 DMA 控制器与 CPU 同时需要访问主存或总线资源时，如果 DMA 全面占用总线，会导致 **CPU 饥饿**；
    
- 需要一种方式让 DMA 与 CPU **交替使用总线**，既保证数据搬运效率，又不完全阻断 CPU 的运行。
    

### 解决方案：

- 引入 **周期窃取机制**，DMA 控制器通过“借用”CPU的部分总线周期来传输数据。
    

---

## 三、周期窃取的工作机制

1. **CPU 正常运行中**；
    
2. **DMA 控制器向总线仲裁逻辑发出总线请求**；
    
3. **在当前 CPU 指令执行间隙**，DMA **窃取一个内存周期**进行一次数据传输；
    
4. 数据传输完成后，控制权归还给 CPU，继续运行；
    
5. 如此循环，直到 DMA 完成设定的全部数据搬运。
    

---

## 四、与其他 DMA 工作模式比较

| 模式           | CPU 可用性 | 传输效率 | 特点                      |
| ------------ | ------- | ---- | ----------------------- |
| **周期窃取**     | 有限影响    | 中等   | **每次传一个单位，交替执行**        |
| **突发传送**     | 传输期间阻塞  | 高    | **一次传多个单位**，效率高但 CPU 暂停 |
| **CPU 空闲传送** | 不影响     | 低    | 仅在 CPU 空闲时传输，效率较低       |

---

## 五、考研常考点 & 典型考法

### 📝 常考识记点：

- “DMA 周期窃取”是否会使 CPU 暂时停顿？➡ **是，但只占用部分周期**
    
- “周期窃取是否与中断机制冲突？”➡ **不会，因为控制权交替明确**
    

### 🎯 例题（选择题）：

**在 DMA 的周期窃取方式中，下列描述正确的是：**  
A. DMA 控制器连续传输整个数据块后再交还总线控制权  
B. CPU 会完全被挂起，直到传输完成  
C. DMA 控制器与 CPU 轮流占用总线，一个周期传输一次  
D. DMA 在 CPU 空闲时才开始传输数据

✔️ 正确答案：**C**

📘 解析：A是突发方式；B错误，只有部分暂停；D是 CPU 空闲传输模式。

---

## 六、与其他系统机制的联系

|相关领域|联系说明|
|---|---|
|**总线仲裁**|DMA 请求总线时必须通过总线仲裁，避免冲突|
|**中断系统**|DMA 传输完成后通过中断通知 CPU|
|**操作系统调度**|DMA 周期窃取减少 CPU 中断次数，有利于实时性|
|**嵌入式系统设计**|设计传感器或音频采集模块时，周期窃取减少对主核干扰|
|**主存系统优化**|高频率周期窃取可能造成主存带宽瓶颈，需设定合理节奏|

---

## 七、周期窃取的优势与局限

### ✅ 优势：

- **提高资源并发使用率**；
    
- **降低 CPU 挂起时间**，适合中速设备（如串口通信、实时音频）；
    
- **不需要复杂调度算法**。
    

### ❌ 局限：

- 高频率周期窃取会造成 CPU 明显降速；
    
- 不适合高速大数据设备（如 SSD、GPU 传输）；
    
- 实现较突发传输复杂，需要精确控制总线仲裁。
    

---

## 八、总结

- **DMA 周期窃取是一种平衡效率与响应的中庸策略**；
    
- 是考研《计算机组成原理》**常考的 DMA 细节知识点**，尤其在对比题与流程题中出现频率高；
    
- 它体现了系统设计中 **性能与响应时间的权衡思想**，是理解 DMA 精髓的重要一环。
    
