# Gray Code 格雷码

## 概念定义

**格雷码（Gray Code）**是一种特殊的**二进制编码方式**，其特点是：**相邻两个码只有一位二进制数不同**，又称为**反射码（Reflected Binary Code）**。

### 缩写说明

- **RBC**：Reflected Binary Code，反射二进制码
    
- **LSB**：Least Significant Bit，最低有效位
    
- **MSB**：Most Significant Bit，最高有效位
    

## 编码规则

设原始的 **n 位二进制码为 B[n-1:0]**，对应的 **格雷码为 G[n-1:0]**，则有：

```
G[n-1] = B[n-1]  （最高位保持不变）
G[i] = B[i+1] XOR B[i]  （其余位为相邻位异或）
```

**逆变换（Gray 码转二进制）**：

```
B[n-1] = G[n-1]
B[i] = B[i+1] XOR G[i]
```

## 举例说明

以3位二进制为例，Gray码如下：

|Binary|Gray|
|---|---|
|000|000|
|001|001|
|010|011|
|011|010|
|100|110|
|101|111|
|110|101|
|111|100|

可见任意相邻两个格雷码仅一位不同。

## 应用场景

- **模拟到数字转换器（ADC, Analog to Digital Converter）**：防止在位同时变化时出现错误。
    
- **电路状态机转换**：减少毛刺干扰，适用于同步电路设计。
    

## 与相关编码的比较

|编码类型|相邻变化位数|是否适合硬件电路过渡|是否为权码|
|---|---|---|---|
|二进制编码|多位可能变化|容易产生毛刺|是|
|格雷码|一位变化|减少毛刺干扰|否|
|8421码（BCD码）|按权编码|适合十进制转换|是|

## 经典例题（计算机组成原理考研常见）

### 例题1：给定二进制数 `1011`，求其对应的格雷码。

**解**：

```
B = 1 0 1 1
G[3] = B[3] = 1
G[2] = B[3] ⊕ B[2] = 1 ⊕ 0 = 1
G[1] = B[2] ⊕ B[1] = 0 ⊕ 1 = 1
G[0] = B[1] ⊕ B[0] = 1 ⊕ 1 = 0
=> Gray = 1110
```

### 例题2：Gray码 `1000` 对应的二进制数是多少？

**解**：

```
G = 1 0 0 0
B[3] = G[3] = 1
B[2] = B[3] ⊕ G[2] = 1 ⊕ 0 = 1
B[1] = B[2] ⊕ G[1] = 1 ⊕ 0 = 1
B[0] = B[1] ⊕ G[0] = 1 ⊕ 0 = 1
=> Binary = 1111
```

## 联系与扩展

- **状态机设计**：在硬件有限状态机（FSM, Finite State Machine）中采用 Gray 编码可降低状态跃迁时的冒险（Hazard）现象。
    
- **哈夫曼编码（Huffman Code）**：虽然不是 Gray Code，但同样强调编码之间的结构特性以减少出错或优化性能。
    
- **异或运算在数字逻辑中的普遍性**：Gray码生成依赖异或运算，掌握 XOR（异或）的性质有助于理解加法器、奇偶校验等模块。
    